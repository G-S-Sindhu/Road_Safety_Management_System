"use strict";(self.webpackChunkDOCKETRUN=self.webpackChunkDOCKETRUN||[]).push([[558],{1558:($,m,n)=>{n.r(m),n.d(m,{LogHistoryModule:()=>X});var c=n(9569),g=n(2953),y=n(3056),x=n(1954),b=n(1305),f=n(7185),P=n(4612),I=n(9174),u=n(7445),h=n(9646),t=n(4650),O=n(2688),S=n(3868),M=n(6895),p=n(8783),L=n(1968);const T=["dangerAlert"];function V(e,a){1&e&&t.\u0275\u0275element(0,"fa-icon",27)}function H(e,a){1&e&&t.\u0275\u0275element(0,"fa-icon",28)}function E(e,a){1&e&&t.\u0275\u0275element(0,"fa-icon",29)}function D(e,a){1&e&&t.\u0275\u0275element(0,"fa-icon",30)}function j(e,a){1&e&&t.\u0275\u0275element(0,"router-outlet")}function A(e,a){if(1&e&&(t.\u0275\u0275elementStart(0,"p-tabPanel",31),t.\u0275\u0275template(1,j,1,0,"router-outlet",32),t.\u0275\u0275elementEnd()),2&e){const o=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",0==o.activeIndex)}}function R(e,a){1&e&&t.\u0275\u0275element(0,"router-outlet")}function F(e,a){if(1&e&&(t.\u0275\u0275elementStart(0,"p-tabPanel",33),t.\u0275\u0275template(1,R,1,0,"router-outlet",32),t.\u0275\u0275elementEnd()),2&e){const o=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",1==o.activeIndex)}}function K(e,a){1&e&&t.\u0275\u0275element(0,"router-outlet")}function N(e,a){if(1&e&&(t.\u0275\u0275elementStart(0,"p-tabPanel",34),t.\u0275\u0275template(1,K,1,0,"router-outlet",32),t.\u0275\u0275elementEnd()),2&e){const o=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",2==o.activeIndex)}}function J(e,a){1&e&&t.\u0275\u0275element(0,"router-outlet")}function Z(e,a){if(1&e&&(t.\u0275\u0275elementStart(0,"p-tabPanel",35),t.\u0275\u0275template(1,J,1,0,"router-outlet",32),t.\u0275\u0275elementEnd()),2&e){const o=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",3==o.activeIndex)}}function z(e,a){1&e&&t.\u0275\u0275element(0,"router-outlet")}function Q(e,a){if(1&e&&(t.\u0275\u0275elementStart(0,"p-tabPanel",36),t.\u0275\u0275template(1,z,1,0,"router-outlet",32),t.\u0275\u0275elementEnd()),2&e){const o=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",4==o.activeIndex)}}function B(e,a){1&e&&t.\u0275\u0275element(0,"router-outlet")}function w(e,a){if(1&e&&(t.\u0275\u0275elementStart(0,"p-tabPanel",37),t.\u0275\u0275template(1,B,1,0,"router-outlet",32),t.\u0275\u0275elementEnd()),2&e){const o=t.\u0275\u0275nextContext();t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",5==o.activeIndex)}}function U(e,a){if(1&e&&(t.\u0275\u0275elementStart(0,"div",38)(1,"div",4)(2,"div",5),t.\u0275\u0275element(3,"img",39),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(4,"div",40)(5,"h5")(6,"span",41),t.\u0275\u0275text(7," Camera Name :"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(8,"b")(9,"span",41),t.\u0275\u0275text(10),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(11,"h5")(12,"span",41),t.\u0275\u0275text(13," Detected Time : "),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(14,"b")(15,"span",41),t.\u0275\u0275text(16),t.\u0275\u0275pipe(17,"dateFormater"),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(18,"h5")(19,"span",41),t.\u0275\u0275text(20," Violation Type :"),t.\u0275\u0275elementEnd(),t.\u0275\u0275elementStart(21,"b")(22,"span",41),t.\u0275\u0275text(23),t.\u0275\u0275elementEnd()()()()()()),2&e){const o=t.\u0275\u0275nextContext();t.\u0275\u0275advance(3),t.\u0275\u0275property("src",o.API+"/image/"+o.currentViol.analyticstype+"/"+o.currentViol.imagename,t.\u0275\u0275sanitizeUrl),t.\u0275\u0275advance(7),t.\u0275\u0275textInterpolate(o.currentViol.camera_name?o.currentViol.camera_name:"null"),t.\u0275\u0275advance(6),t.\u0275\u0275textInterpolate(o.currentViol.timestamp?t.\u0275\u0275pipeBind1(17,4,o.currentViol.timestamp):"--"),t.\u0275\u0275advance(7),t.\u0275\u0275textInterpolate(o.currentViol.analyticstype?o.aiSolutionsList[o.currentViol.analyticstype]:"null")}}let G=(()=>{class e{constructor(o,i,r,l,d,Y){this.webServer=o,this.toasterService=i,this.router=r,this.activatedRoute=l,this.configService=d,this.Router=Y,this.aiSolutionsList={CRDCNT:"Crowd Count",RA:"Danger Zone",PPE:"PPE"},this.data=[],this.delay=3e3,this.isalert=!1,this.getObjectKeys=Object.keys,this.tempdata=[],this.audio=new Audio,this.audioOff=!1,this.alertmessage="",this.total=(0,h.of)(0),this.violData=(0,h.of)([]),this.loading=!1,this.prevLiveCount=0,this.images=[],this.violLength=0,this.updatedLen=0,this.violdata=[],this.currentViol=null,this.activeIndex=0,this.alert=!0,this.Images=[],this.isActive=!1,this.isActive2=!1,this.violationsList=[],this.Router.navigate(["app/violations/DangerZone"]),this.audio.src="../../../assets/audio/alert.mp3",this.audio.load(),this.audioOff="true"==localStorage.getItem("audioOff"),this.alert="true"==localStorage.getItem("alert"),console.log(localStorage.getItem("audioOff"),localStorage.getItem("alert")),this.delay=this.webServer.logInterval,this.API=o.IP,this.webServer.LiveViolationData().subscribe(s=>{s.success&&(this.prevLiveCount=s.now_live_count)},s=>{}),this.webServer.CheckApplicationStatus().subscribe(s=>{if(console.log(s),s.success){localStorage.setItem("appStatus",s.message[0].process_status);var v=s.message.find(C=>"docketrun-app"==C.process_name?C:"");this.isActive=v?v.process_status:""}}),this.GetMockdrillStatus()}ngOnInit(){}ngAfterViewInit(){this.violationContainer=this.Violation.nativeElement.innerHTML,this.dataread()}dataread(){this.webServer.liveViolInterval=setInterval(()=>{this.Subsciption=this.webServer.LiveViolationData().subscribe(o=>{const i={...o};if(i.success){var r=[...i.message],l=i.now_live_count-this.prevLiveCount;if(l>0&&this.alert){for(let d=l-1;d>=0;d--)this.alert&&setTimeout(()=>{this.currentViol=r[d],this.alert&&this.showViol(),this.audioOff||this.alertSound()},100);this.prevLiveCount=i.now_live_count}}})},this.delay)}showViol(){console.log("current viol",this.currentViol),this.alert&&this.toasterService.error(this.Violation.nativeElement.innerHTML," ",{enableHtml:!0,positionClass:"toast-top-right"})}alertSound(){this.audio.play()}volumeToggle(){this.alert?(this.audioOff=!this.audioOff,localStorage.setItem("audioOff",this.audioOff?"true":"false")):(this.audioOff=!0,localStorage.setItem("audioOff","true"))}alertToggle(){this.alert=!this.alert,localStorage.setItem("alert",this.alert?"true":"false"),this.alert||(this.audioOff=!0,localStorage.setItem("alert","false"),localStorage.setItem("audioOff","true"),this.toasterService.clear())}OnTabChange(o){switch(o.index){case 0:this.activeIndex=0,this.router.navigate(["app","violations","DangerZone"]);break;case 1:this.activeIndex=1,this.router.navigate(["app","violations","ppe"]);break;case 2:this.activeIndex=2,this.router.navigate(["app","violations","CrowdCount"]);break;case 3:this.activeIndex=3,this.router.navigate(["app","violations","FireDetection"]);break;case 4:this.activeIndex=4,this.router.navigate(["app","violations","Parking"]);break;case 5:this.activeIndex=5,this.router.navigate(["app","violations","Traffic_Jam"])}}GetMockdrillStatus(){this.webServer.GetMockDrillStatus().subscribe(o=>{this.isActive2=o.success})}ngOnDestroy(){clearInterval(this.webServer.liveViolInterval),this.isalert=!1,this.toasterService.clear()}}return e.\u0275fac=function(o){return new(o||e)(t.\u0275\u0275directiveInject(u.N),t.\u0275\u0275directiveInject(f._W),t.\u0275\u0275directiveInject(c.F0),t.\u0275\u0275directiveInject(c.gz),t.\u0275\u0275directiveInject(O.l),t.\u0275\u0275directiveInject(c.F0))},e.\u0275cmp=t.\u0275\u0275defineComponent({type:e,selectors:[["app-log-history"]],viewQuery:function(o,i){if(1&o&&t.\u0275\u0275viewQuery(T,5),2&o){let r;t.\u0275\u0275queryRefresh(r=t.\u0275\u0275loadQuery())&&(i.Violation=r.first)}},decls:33,vars:14,consts:[["id","content",1,"container-fluid","dashboard-content"],["datatable",""],[1,""],[1,"page-header"],[1,"row"],[1,"col-12"],[1,"card-header"],["placement","bottom",1,"btn","default-outline","me-2","float-start",2,"width","7%",3,"ngbTooltip","click"],["icon","bell","class","me-1",4,"ngIf"],["icon","bell-slash","class","me-1",4,"ngIf"],["placement","bottom",1,"btn","default-outline","float-start","me-2",2,"width","7%",3,"ngbTooltip","click"],["icon","volume-up","class","me-1",4,"ngIf"],["icon","volume-off","class","me-1",4,"ngIf"],["id","data-card",1,"card","card-body","mt-3"],[3,"activeIndex","onChange","activeIndexChange"],["header","Danger Zone",4,"ngIf"],["header","Personal Protective Equipment",4,"ngIf"],["header","Crowd Count",4,"ngIf"],["header","Fire and Dust Detection",4,"ngIf"],["header","Parking Management",4,"ngIf"],["header","Traffic-Jam",4,"ngIf"],[2,"display","none"],["dangerAlert",""],[1,"mb-0",2,"border","2px solid rgba(121, 20, 20, 0.699)","background-color","rgba(214, 148, 148, 0.459)"],[1,"modal-header",2,"text-align","center","color","rgba(121, 20, 20, 0.699)"],[1,"",2,"color","rgb(196, 54, 54) !important"],["class","modal-body",4,"ngIf"],["icon","bell",1,"me-1"],["icon","bell-slash",1,"me-1"],["icon","volume-up",1,"me-1"],["icon","volume-off",1,"me-1"],["header","Danger Zone"],[4,"ngIf"],["header","Personal Protective Equipment"],["header","Crowd Count"],["header","Fire and Dust Detection"],["header","Parking Management"],["header","Traffic-Jam"],[1,"modal-body"],["alt","","width","100%",1,"violImage",2,"object-fit","fill","border-radius","5px 5px 5px 5px",3,"src"],[1,"col-xl-12","col-md-12","col-lg-12","col-xs-12","text-white","mt-2"],[1,"text-white"]],template:function(o,i){1&o&&(t.\u0275\u0275elementStart(0,"div",0,1)(2,"div",2)(3,"h3",3),t.\u0275\u0275text(4,"Violations Details"),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(5,"div",4)(6,"div",5)(7,"div",6)(8,"button",7),t.\u0275\u0275listener("click",function(){return i.alertToggle()}),t.\u0275\u0275template(9,V,1,0,"fa-icon",8),t.\u0275\u0275template(10,H,1,0,"fa-icon",9),t.\u0275\u0275elementEnd(),t.\u0275\u0275text(11,"\xa0 "),t.\u0275\u0275elementStart(12,"button",10),t.\u0275\u0275listener("click",function(){return i.volumeToggle()}),t.\u0275\u0275template(13,E,1,0,"fa-icon",11),t.\u0275\u0275template(14,D,1,0,"fa-icon",12),t.\u0275\u0275elementEnd(),t.\u0275\u0275text(15,"\xa0 "),t.\u0275\u0275elementEnd()()(),t.\u0275\u0275elementStart(16,"div",13)(17,"p-tabView",14),t.\u0275\u0275listener("onChange",function(l){return i.OnTabChange(l)})("activeIndexChange",function(l){return i.activeIndex=l}),t.\u0275\u0275template(18,A,2,1,"p-tabPanel",15),t.\u0275\u0275template(19,F,2,1,"p-tabPanel",16),t.\u0275\u0275template(20,N,2,1,"p-tabPanel",17),t.\u0275\u0275template(21,Z,2,1,"p-tabPanel",18),t.\u0275\u0275template(22,Q,2,1,"p-tabPanel",19),t.\u0275\u0275template(23,w,2,1,"p-tabPanel",20),t.\u0275\u0275elementEnd()(),t.\u0275\u0275elementStart(24,"div",21)(25,"div",5)(26,"div",null,22)(28,"div",23)(29,"div",24)(30,"h3",25),t.\u0275\u0275text(31," Violation "),t.\u0275\u0275elementEnd()(),t.\u0275\u0275template(32,U,24,6,"div",26),t.\u0275\u0275elementEnd()()()()()),2&o&&(t.\u0275\u0275advance(8),t.\u0275\u0275property("ngbTooltip",i.alert?"notification on":"notification off"),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.alert),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!i.alert),t.\u0275\u0275advance(2),t.\u0275\u0275property("ngbTooltip",i.audioOff?"mute":"unmute"),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",!i.audioOff),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.audioOff),t.\u0275\u0275advance(3),t.\u0275\u0275property("activeIndex",i.activeIndex),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.getObjectKeys(i.configService.aiSolutionsList).indexOf("RA".toLowerCase())>=0),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.getObjectKeys(i.configService.aiSolutionsList).indexOf("PPE".toLowerCase())>=0),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.getObjectKeys(i.configService.aiSolutionsList).indexOf("CR".toLowerCase())>=0),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.getObjectKeys(i.configService.aiSolutionsList).indexOf("fire")>=0),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.getObjectKeys(i.configService.aiSolutionsList).indexOf("parking")>=0),t.\u0275\u0275advance(1),t.\u0275\u0275property("ngIf",i.getObjectKeys(i.configService.aiSolutionsList).indexOf("traffic_jam")>=0),t.\u0275\u0275advance(9),t.\u0275\u0275property("ngIf",i.currentViol))},dependencies:[S.BN,M.NgIf,g._L,c.lC,p.xf,p.x4,L.J],styles:['.image[_ngcontent-%COMP%]{margin-left:0;margin-right:0;height:174px;width:330px;object-fit:cover;border-radius:5px!important}.task-input[_ngcontent-%COMP%]{padding:0 25px;position:relative}.task-input[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding:5px 35px 5px 5px;height:40px}.datePickerContainer[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center}.datePickerContainer[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border-top-right-radius:0!important;border-bottom-right-radius:0!important}input[_ngcontent-%COMP%]{width:100%}.img[_ngcontent-%COMP%]{height:20px;width:20px}.task-input[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{top:50%;position:absolute;transform:translate(170px,-50%)}input[type=checkbox][_ngcontent-%COMP%]{display:block;height:30px;margin:0 0 -53px -9999px;order:4;top:5px;outline:none;counter-increment:undone-items}input[_ngcontent-%COMP%]:checked{pointer-events:none;order:2;counter-increment:done-items}label[_ngcontent-%COMP%]{pointer-events:none;display:block;position:relative;padding:15px 10px 15px 0;border-top:1px dashed #fff;order:4;cursor:pointer;animation:undone .5s}label[_ngcontent-%COMP%]:before{content:"\\f10c";display:block;position:absolute;margin-right:10px;margin-left:10px}input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{order:2;animation:done .5s}input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:before{margin-left:3px;margin-right:2rem!important;color:#cc1d1d;content:"\\2713"}input[_ngcontent-%COMP%] + label[_ngcontent-%COMP%]:before{margin-left:3px;margin-right:2rem!important;color:#cc1d1d;content:"\\2716"}#editViol[_ngcontent-%COMP%]{text-align:center;align-content:center}td[_ngcontent-%COMP%]{text-align:center!important;align-content:center!important}input[type=radio][_ngcontent-%COMP%]{display:block;height:30px;margin:0 0 -53px -9999px;order:4;outline:none;position:relative;counter-increment:undone-items}#verify[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{pointer-events:all;display:block;position:relative;border-top:1px dashed #fff;order:4;cursor:pointer;animation:undone .5s;margin-left:10px!important}#verify[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:before{content:"\\25ef";display:block;position:absolute;margin-right:10px!important;right:2rem;font-weight:500;color:#c9c9c9}#verify[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]{order:2;animation:done .5s}#verify[_ngcontent-%COMP%]   #wrong[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:before{font-size:larger;font-family:500;color:#cc1d1d;content:"\\2713"}#verify[_ngcontent-%COMP%]   #right[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + label[_ngcontent-%COMP%]:before{font-size:larger;font-family:700;color:#1dc41d;content:"\\2713"}.w-full[_ngcontent-%COMP%]{width:inherit!important;color:#000!important}']}),e})();var k=n(64);const W=[{path:"",component:G,children:[{path:"ppe",loadChildren:()=>Promise.all([n.e(153),n.e(177),n.e(764)]).then(n.bind(n,7764)).then(e=>e.PpeviolationModule)},{path:"CrowdCount",loadChildren:()=>n.e(484).then(n.bind(n,2484)).then(e=>e.CrowdCountViolationsModule)},{path:"DangerZone",loadChildren:()=>Promise.all([n.e(153),n.e(788),n.e(47),n.e(382)]).then(n.bind(n,7382)).then(e=>e.RaViolationsModule)},{path:"FireDetection",loadChildren:()=>Promise.all([n.e(788),n.e(760)]).then(n.bind(n,9760)).then(e=>e.FireAndSmokeViolationModule)},{path:"SpillageDetection",loadChildren:()=>Promise.all([n.e(788),n.e(196)]).then(n.bind(n,2196)).then(e=>e.SpillageViolationModule)},{path:"Parking",loadChildren:()=>n.e(303).then(n.bind(n,1303)).then(e=>e.ParkingViolationsModule)},{path:"Traffic_Jam",loadChildren:()=>n.e(413).then(n.bind(n,7413)).then(e=>e.TrafficJamViolationsModule)}]}];let X=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.\u0275\u0275defineNgModule({type:e}),e.\u0275inj=t.\u0275\u0275defineInjector({providers:[u.N],imports:[I.A,c.Bz.forChild(W),b.QM,k.o6,y.ZQ.forRoot(),f.Rh.forRoot({timeOut:5e3,toastComponent:P.n,progressBar:!0,newestOnTop:!0,tapToDismiss:!0}),p.LU,x.n1.forRoot({}),g.IJ,c.Bz]}),e})()}}]);