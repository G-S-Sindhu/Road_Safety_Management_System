<div class="dashboard-content" id="page">
    <div class="page-header">
        <h3>Camera Settings</h3>
    </div>
  
    <div class="row">
        <div class="float-end">
        
            <button
                *ngIf="!isApplicationActive"
                [disabled]=" enabledAnalyticsCamCount == 0"
                class="float-end ms-2 btn primary"
                (click)="OpenStartApplicationModal(startApplicationModal)">
                Start Application
            </button>
            <button
                *ngIf="isApplicationActive"
                class="float-end ms-2 btn danger"
                
                (click)="OpenStopApplicationModal(stopApplicationModal)">
                Stop Application
            </button>

        </div>
    </div>
  
    <div class="mb-2 col-12">
        <h4 class="sub-header">
            <b>Pre-Check Cameras</b>
                <fa-icon
                    *ngIf="!showUploadOption"
                    (click)="ToggleShowUpload()"
                    class="text-prime c-pointer ms-1 mt-1 mb-1"
                    icon="plus">
                </fa-icon>
                <fa-icon
                    *ngIf="showUploadOption"
                    (click)="ToggleShowUpload()"
                    class="text-prime c-pointer ms-1 mt-1 mb-1"
                    icon="minus">
                </fa-icon>
        </h4>

        <div style="border-radius: 4px" class="row" *ngIf="showUploadOption">
            <div class="col-10">
                <div class="container-e">
                    <div>
                        <p class="mb-2">
                            Upload a list of cameras in excel sheet to verify their status
                            before adding them to this system.
                        </p>
  
                        <div id="ExcelContainer" class="mb-2">
                            <input
                                class="form-control form-control-lg"
                                id="formFileLg"
                                accept=".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel"
                                (change)="OnFileSelect($event)"
                                type="file"/>
                        </div>
                        <div class="d-flex justify-centent-center mt-2" style="width: 100%">
                            <button
                                class="btn default"
                                style="width: inherit"
                                (click)="DownloadCameraExcel()"
                                *ngIf="isDownloadCamStatusExcel">
                                <fa-icon
                                    class="me-2"
                                    *ngIf="!isDownloadingCamStatusExcel"
                                    icon="download">
                                </fa-icon>
                                <span
                                    class="spinner-border spinner-border-sm me-1"
                                    role="status"
                                    aria-hidden="true"
                                    *ngIf="isDownloadingCamStatusExcel">
                                </span>
                                Download Cameras Status Excel
                            </button>
                        </div>
                    </div>
                </div>
            </div>
  
            <div class="col-2">
                <div class="h-100 w-100">
                    <button
                        class="btn default-outline h-100 w-100 ms-2"
                        (click)="GetCameraSampleSheet()">
                            <fa-icon icon="file-arrow-down" class="h5"></fa-icon>
                            <span class="h5"> Download Excel Format</span><br/>
                            <small>Uploading Excel should be in this format</small>
                            <span></span>
                    </button>
                </div>
            </div>

        </div>
    </div>

    <h4 class="sub-header">Camera Details</h4>
  
    <div class="card mb-2" id="data-card">
        <span class="">
            <div class="d-flex justify-content-center align-items-center">
                <span class="me-2 large-text">
                    <span class="text-prime me-2"><b>Total Camera Licenses :</b></span>
                    {{ licenseDetails ? licenseDetails.total_license : "--" }}
                </span>
                <span class="me-2 large-text">
                    <span class="text-prime me-2"><b>Utilized Camera Licenses :</b></span>
                    {{ licenseDetails ? licenseDetails.added_cameras_count : "--"}}
                </span>
                <span class="me-2 large-text">
                    <span class="text-prime me-2"><b>Remaining Camera Licenses :</b></span>
                    {{ licenseDetails ? licenseDetails.remaining_license : "--" }}
                </span>
            </div>
        </span>
    </div>
    
    <div class="col-12">
        <div class="card" id="data-card">
            <div class="card-header">
                <h5 class="float-start"><b>Camera Details</b></h5>
                <div class="col-xl-2 col-lg-2 col-sm-6 col-xs-12 col-md-6 float-end">
                    <ng-multiselect-dropdown
                        [placeholder]="'Hide Column'"
                        [settings]="hideColumnDropdownSettings"
                        [data]="hideColumnHeaders"
                        [(ngModel)]="selectedHideColumn"
                        (onSelect)="onHideColumn($event)"
                        (onDeSelect)="onShowColumn($event)">
                    </ng-multiselect-dropdown>
                </div>
                <button
                    class="btn default-outline float-end me-2"
                    (click)="GetAddedCamerasDetails()" >
                    <fa-icon icon="rotate" class="me-1"></fa-icon>  
                    Refresh Camera Details
                </button>
                <div class="col-xl-2 float-end me-2">
                    <button class="float-end btn default" (click)="openAddCameraModal(addCameraModal)">
                        <fa-icon icon="plus" class="me-2"></fa-icon>Add Camera
                    </button>
                </div>
            </div>

            <div class="table">
                <table class="table table-bordered p-datatable-thead" id="dataTable">
                    <thead>
                        <tr>
                            <th
                                scope="col"
                                sortable
                                *ngIf="!(hideColumns.indexOf(0) >= 0)">
                                SI No
                            </th>
                            <th
                                scope="col"
                                sortable
                                *ngIf="!(hideColumns.indexOf(1) >= 0)">
                                Camera Name
                            </th>
                            <th
                                scope="col"
                                sortable
                                *ngIf="!(hideColumns.indexOf(5) >= 0)">
                                Camera Brand
                            </th>
  
                            <th
                                scope="col"
                                sortable
                                *ngIf="!(hideColumns.indexOf(2) >= 0)">
                                Camera Image
                            </th>
                            <th
                                scope="col"
                                sortable
                                *ngIf="!(hideColumns.indexOf(9) >= 0)">
                                Camera IP
                            </th>
  
                            <th
                                scope="col"
                                sortable
                                *ngIf="!(hideColumns.indexOf(3) >= 0)">
                                Department
                            </th>
                            <th
                                scope="col"
                                sortable
                                *ngIf="!(hideColumns.indexOf(4) >= 0)">
                                Area
                            </th>
                            <th
                                scope="col"
                                sortable
                                *ngIf="!(hideColumns.indexOf(10) >= 0)">
                                AI Solutions
                            </th>
                            <!-- <th 
                                scope="col" 
                                sortable 
                                *ngIf="!(hideColumns.indexOf(10) >= 0)">
                                Violations Count
                            </th> -->
                    
                            <th 
                                scope="col" 
                                *ngIf="!(hideColumns.indexOf(11) >= 0)">
                                Enable<br/>
                                AI Solutions
                            </th>
                            <th
                                style="width: 8rem !important"
                                scope="col"
                                sortable
                                *ngIf="!(hideColumns.indexOf(8) >= 0)">
                                Settings
                            </th>
                        </tr>
                    </thead>

                    <tbody *ngIf="(addedCamerasList | async).length > 0; else noData">
                        <tr
                            class="mx-auto my-auto"
                            style="text-align: center"
                            *ngFor="let camera of addedCamerasList | async; let i = index">

                            <td
                                style="text-align: center"
                                *ngIf="!(hideColumns.indexOf(0) >= 0)">
                                {{ camera.SNo }}
                            </td>
                            <td
                                style="text-align: center"
                                class="align-items-center"
                                *ngIf="!(hideColumns.indexOf(1) >= 0)">
                                {{ camera.cameraname }}
                            </td>
                            <td
                                style="text-align: center"
                                class="align-items-center"
                                *ngIf="!(hideColumns.indexOf(5) >= 0)">
                                {{ camera.camera_brand }}
                            </td>
  
                            <td class="" *ngIf="!(hideColumns.indexOf(2) >= 0)">
                                <div class="d-block">
                                    <img
                                        [src]="IP + '/get_roi_image/' + camera.imagename"
                                        alt="Not Found"
                                        class="camera-image"
                                        (click)="open(camera.SNo)"/>
                                </div>
                            </td>

                            <td *ngIf="!(hideColumns.indexOf(9) >= 0)">
                                <div class="column-flex justify-centent-center">
                                    <div
                                        style="width: 6rem !important"
                                        class="d-flex justify-centent-center align-items-center">
                                        {{ camera.camera_ip }}
                                    </div>
                                </div>
                            </td>
  
                            <td
                                style="text-align: center"
                                *ngIf="!(hideColumns.indexOf(3) >= 0)">
                                {{ camera.department }}
                            </td>
                            <td
                                style="text-align: center"
                                *ngIf="!(hideColumns.indexOf(4) >= 0)">
                                {{ camera.area }}
                            </td>
                            <td class="" *ngIf="!(hideColumns.indexOf(10) >= 0)">
                                <div class="d-flex justify-content-center align-items-center">
                                    <div class="d-flex justify-content-center align-items-center">
                                    <!-- <table>
                                            <thead>
                                                <tr>
                                                    <th scope="col"></th>
                                                    <th scope="col"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr
                                                    *ngFor="
                                                    let ai_solution of Object.keys(
                                                    camera.ai_solution)">
                                                    <td class="me-2" scope="col">
                                                        {{ aiSolutions[ai_solution] }}
                                                    </td>
                                                    <td class="form-check form-switch" scope="col">
                                                        <input
                                                            class="form-check-input"
                                                            type="checkbox"
                                                            (change)="
                                                                SetAISolution(camera, $event, ai_solution)
                                                                "
                                                             role="switch"
                                                            [checked]="camera.ai_solution[ai_solution]"
                                                            id="flexSwitchCheckDefault"
                                                        />
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table> -->
                                    </div>
                                </div>
                            </td>
                            <!-- <td class="" *ngIf="!(hideColumns.indexOf(10) >= 0)">
                                <div class="d-flex justify-content-center align-items-center">
                                    <div class="d-flex justify-content-center align-items-center">
                                    <table style="width: 12rem">
                                            <thead class="w-100">
                                                <tr>
                                                    <th scope="col" class="w-100"></th>
                                                    <th scope="col" class="w-100"></th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr
                                                    *ngFor="
                                                    let ai_solution of Object.keys(camera.ai_solution)
                                                    "
                                                    class="text-clickable">
                                                    <td class="me-2" scope="col">
                                                        {{ aiSolutions[ai_solution] }}
                                                    </td>
                                                    <td class="text-prime" scope="col">
                                                        0
                                                    </td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </td> -->
                        <!-- <td
                                style="text-align: center"
                                *ngIf="!(hideColumns.indexOf(6) >= 0)">
                                <div class="column-flex">
                                    <span class="" *ngIf="camera.alarm_type.hooter">
                                        Hooter </span><br />
                                    <span class="" *ngIf="camera.alarm_type.relay">
                                        Relay </span><br />
  
                                    <br />
                                </div>
                            </td> -->
                        <!-- <td
                            style="text-align: center"
                            *ngIf="!(hideColumns.indexOf(7) >= 0)"
                            >
                                <div class="column-flex">
                                    <div class="m-2" *ngIf="camera.alarm_type.hooter">
                                        <span class="text-muted me-2">Hooter IP:</span>
                                            {{ camera.alarm_ip_address.hooter_ip }}
                                    </div>
                                    <div class="m-2" *ngIf="camera.alarm_type.relay">
                                        <span class="text-muted me-2">Relay IP:</span>
                                        {{
                                            camera.alarm_ip_address.relay_ip
                                            ? camera.alarm_ip_address.relay_ip
                                            : "--"
                                        }}
                                    </div>
                                </div>
                            </td> -->
  
                            <td *ngIf="!(hideColumns.indexOf(11) >= 0)">
                                <!-- <input
                                    type="checkbox"-
                                    hidden="hidden"
                                    [checked]="
                                    camera.analytics_status == 'true' ? true : false
                                    "
                                    (change)="EnableAnalytics(camera, $event)"
                                    [id]="'camera' + camera.SNo"
                                />
                                <label class="switch" [for]="'camera' + camera.SNo"></label> -->
                            </td>
                            <!-- <td *ngIf="showAiSolutions"><input type="checkbox" class="form-check-input" name="RackIn" id="">&nbsp;<label class="form-check-label">PPE</label>
                            </td> -->
                            <td *ngIf="!(hideColumns.indexOf(8) >= 0)">
                                <button
                                    class="btn default-outline mb-2 w-100"
                                    (click)="OpenEditCameraModal(editCameraModal, camera)"
                                >
                                    <fa-icon class="" icon="pen-to-square"></fa-icon> Camera
                                    Details
                                </button>
                                <br/>
  
                                <button
                                    class="btn default-outline mb-2"
                                    (click)="goToRoiEdit(camera._id.$oid, camera.imagename)">
                                    &nbsp; <fa-icon icon="cog" class="me-1"></fa-icon> AI
                                    Solutions &nbsp;
                                </button><br />
                                <!-- &nbsp;&nbsp; -->
                                <button
                                    class="btn danger-outline mb-2 w-100"
                                    (click)="isDelete(deleteModal, camera)">
                                    <fa-icon class="me-1" icon="trash"></fa-icon>Delete Camera
                                </button>
                            </td>
                        </tr>
                    </tbody>
                    <ng-template #noData>
                        <tbody>
                            <tr>
                                <td colspan="14">
                                    <div class="card card-body" id="data-card">
                                        <div
                                            class="d-flex justify-content-center align-items-center text-muted"
                                            *ngIf="dataFetchStatus == 'success'">
                                            <h4>No Cameras are Added.</h4>
                                        </div>
                                        <div
                                            class="d-flex justify-content-center align-items-center"
                                            *ngIf="dataFetchStatus == 'init'">
                                            <span
                                                class="spinner-border spinner-border-sm me-2 text-prime"
                                                role="status"
                                                aria-hidden="true">
                                            </span>
                                            Loading...
                                        </div>
                                        <div
                                            class="d-flex justify-content-center align-items-center"
                                            *ngIf="dataFetchStatus == 'error'">
                                            <h5>Error while fetching data</h5>
                                        </div>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </ng-template>
                </table>
                <div class="d-flex mx-auto justify-content-center p-1">
                    <ngb-pagination
                        [collectionSize]="total | async"
                        [(page)]="page"
                        [pageSize]="pageSize"
                        style="width: 95vw; overflow-x: auto"
                        (pageChange)="slice()">
                    </ngb-pagination>
                    <div class="d-flex mx-auto justify-content-start">
                        <div class="col-2">
                            <select
                                class="form-select"
                                style="width: auto"
                                [(ngModel)]="pageSize"
                                (ngModelChange)="slice()">

                                <option [ngValue]="10">10</option>
                                <option [ngValue]="15">15</option>
                                <option [ngValue]="20">20</option>
                                <option [ngValue]="total | async">All Cameras</option>
                            </select>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<ng-template let-modal #startApplicationModal>

    <div class="modal-body">
        <div class="modal-confirm">

            <div class="modal-content">
                <div class="modal-body flex-column">
                    <h5 class="text-dark">Do you want to start the Application ?</h5>
                    <form action="" [formGroup]="startAppConfig" class="">
                        <div class="border rounded p-3">
                            <p class="text-muted">Select Configuration Method</p>
  
                            <div class="form-check form-check-inline" id="custome">
                                <input
                                    type="radio"
                                    [formControlName]="'rtspConfig'"
                                    [value]="0"
                                    [defaultValue]="0"
                                    id="rackin"
                                    class="form-check-input"
                                />
                                <label for="rackin" class="form-check-label text-muted">RTSP
                                </label>
                            </div>
                            <div class="form-check form-check-inline" id="custome">
                                <input
                                    type="radio"
                                    [formControlName]="'rtspConfig'"
                                    [value]="1"
                                    [defaultValue]="1"
                                    id="rackout"
                                    class="form-check-input"
                                />
                                <label for="rackout" class="form-check-label text-muted">RTSPT
                                </label>
                            </div>
                        </div>
  
                        <div class="p-3 m-3 border rounded">
                            <p class="text-muted"></p>
                            <div>
                                <span class="form-check form-check-inline" id="custome">
                                    <input
                                        type="checkbox"
                                        formControlName="VideoAnalyticsConfig"
                                        value="true"
                                        defaultValue="hooter"
                                        id="hooter"
                                        class="form-check-input"
                                    />
                                    <label for="hooter" class="form-check-label text-muted" >
                                    Show The Grid View</label>
                                </span>
                                <!-- <span
                                    class="form-check form-check-inline ms-2"
                                    id="custome"
                                    *ngIf="startAppConfig.get('VideoAnalyticsConfig').value">
                                    <input
                                        type="checkbox"
                                        formControlName="ROIConfig"
                                        value="hooter"
                                        (change)="hooterOrRelayConfig($event)"
                                        defaultValue="hooter"
                                        id="hooter"
                                        class="form-check-input"
                                    />
                                    <label for="hooter" class="form-check-label text-muted">
                                         Display the regions of interest(ROI) that have been Drawn
                                            in all cameras in the Grid View
                                    </label>
                                </span> -->
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer justify-content-center">
                    <button
                        type="button"
                        class="btn btn-secondary"
                        (click)="modal.close('Cross click')"
                         data-dismiss="modal">
                         Cancel
                    </button>
                    <button
                        type="button"
                        class="btn default"
                        (click)="StartApplication()">
                        Start
                    </button>
                </div>
            </div>
        </div>
    </div>
</ng-template>

<ng-template let-modal #stopApplicationModal>
    <div class="modal-body">
        <div class="modal-confirm">
            <div class="modal-content">
                <div class="modal-header flex-column">
                    <div class="icon-box">
                        <i class="material-icons">&#xE5CD;</i>
                    </div>
                    <h4 class="modal-title w-100">Are you sure?</h4>
                    <!-- <button type="button" class="btn"  aria-hidden="true">&times;</button> -->
                </div>
                <div class="modal-body">
                    <p>Do you really want to stop this Application?</p>
                </div>
                <div class="modal-footer justify-content-center">
                    <button
                        type="button"
                        class="btn btn-secondary"
                        (click)="modal.close('Cross click')"
                        data-dismiss="modal">
                        Cancel
                    </button>
                    <button type="button" class="btn danger" (click)="StopApplication()">
                        Stop
                    </button>
                </div>
            </div>
        </div>
    </div>
</ng-template>
  
 
<ng-template let-modal #addCameraModal>

    <div class="border" style="background-color: white">

        <div class="modal-header" id="formContent">
            <h3>
                <b>Add Road Safety Management <br> Camera Details</b>
            </h3>
            <button
                type="button"
                class="btn btn-close"
                aria-label="Close"
                (click)="modal.close('Cross click')">
            </button>
        </div>

        <div class="modal-body">

            <div class="radio-cards" *ngIf="true">

                <div class="radio-card">
                    
                    <div class="radio-input">
                        <input
                            type="radio"
                            [formControl]="addCameraMethod"
                            value="camera_ip"
                            id="cameraIp"
                        />
                        <label for="cameraIp">
                            <span class="selected">
                                <fa-icon icon="circle-check" class="me-1"></fa-icon>
                            </span>
                            Add through camera IP
                        </label>
                    </div>

                </div>

                <div class="radio-card">
                    <div class="radio-input">
                        <input
                            type="radio"
                            [formControl]="addCameraMethod"
                            value="camera_rtsp"
                            id="cameraRtsp"
                        />
                        <label for="cameraRtsp">
                            <span class="selected">
                                <fa-icon icon="circle-check" class="me-1"></fa-icon>
                            </span>
                            Add through camera RTSP
                        </label>
                    </div>
                </div>
          
                <div class="radio-card">
                    <div class="radio-input">
                        <input
                            type="radio"
                            value="excel"
                            [formControl]="addCameraMethod"
                            id="excel"
                        />
                        <label for="excel">
                            <span class="selected">
                                <fa-icon icon="circle-check" class="me-1"></fa-icon>
                            </span>Add through excel
                        </label>
                    </div>
                </div>
            </div>

            <form action="" class="" [formGroup]="AddCameraForm" id="addCameraForm" *ngIf="addCameraMethod. value=='camera_ip'">

                <div class="wrapper-two" id="input">
                    <div class="form-floating">
                        <input
                            type="text"
                            [ngClass]="
                             AddCameraForm.get('cameraname').invalid &&
                             AddCameraForm.get('cameraname').touched
                            ? 'is-invalid'
                            : ''
                            "
                            formControlName="cameraname"
                            placeholder="Camera name"
                            class="form-control"
                            id="cameraname"
                        />
                        <label for="cameraname">
                            Camera Name
                        </label>
                    </div>
                    <div class="form-floating" id="cameraBrand">
             
                        <ng-multiselect-dropdown
                            #singleSelect
                            [placeholder]="'Camera Brand'"
                            [settings]="cameraBrandDropdownSettings | async"
                            [data]="cameraBrandList | async"
                            formControlName="camera_brand">
                        </ng-multiselect-dropdown>
                    </div>
  
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="plant"
                            placeholder="Plant"
                            class="form-control"
                            [ngClass]="
                            AddCameraForm.get('plant').invalid &&
                            AddCameraForm.get('plant').touched
                             ? 'is-invalid'
                            : ''
                            "
                            id="plant"
                        />
                        <label for="plant">
                            Plant
                        </label>
                    </div>
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="area"
                            placeholder="Area"
                            class="form-control"
                            [ngClass]="
                                AddCameraForm.get('area').invalid &&
                                AddCameraForm.get('area').touched
                                ? 'is-invalid'
                                : ''
                                "
                            id="Area"
                        />
                        <label for="Area">
                            Area
                        </label>
                    </div>
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="department"
                            placeholder="Department"
                            class="form-control"
                            [ngClass]="
                                AddCameraForm.get('department').invalid &&
                                AddCameraForm.get('department').touched
                                ? 'is-invalid'
                                : ''
                            "
                            id="department"
                        />
                        <label for="department">
                            Department
                        </label>
                    </div>
                </div>
  
                <div class="wrapper-two" id="input">
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="username"
                            placeholder="User name"
                            class="form-control"
                            [ngClass]="
                            AddCameraForm.get('username').invalid &&
                            AddCameraForm.get('username').touched
                                ? 'is-invalid'
                                : ''
                            "
                            id="username"
                        />
                        <label for="username">Camera User Name</label>
                    </div>
  
                    <div class="form-floating">
                        <input
                            type="text"
                            type="password"
                            formControlName="password"
                            placeholder="Password"
                            class="form-control"
                            [ngClass]="
                                AddCameraForm.get('password').invalid &&
                                AddCameraForm.get('password').touched
                                ? 'is-invalid'
                                : ''
                            "
                            id="password"
                        />
                        <label for="password">Camera Password</label>
                        <span
                            class="text-danger"
                            *ngIf="AddCameraForm.get('password').hasError('pattern')">
                            password should not contain special charecters
                        </span>
                    </div>
  
            
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="cameraip"
                            placeholder="Camera ip"
                            class="form-control"
                            [ngClass]="
                                AddCameraForm.get('cameraip').invalid &&
                                AddCameraForm.get('cameraip').touched
                                ? 'is-invalid'
                                : ''
                            "
                            id="cameraip"
                        />
                        <label for="cameraip">Camera IP</label>
                    </div>
  
           
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="port"
                            placeholder="Port"
                            class="form-control"
                            [ngClass]="
                                AddCameraForm.get('port').invalid &&
                                AddCameraForm.get('port').touched
                                ? 'is-invalid'
                                : ''
                            "
                            id="port"
                        />
                        <label for="port">Port</label>
                    </div>
                </div>

                <div
                    class="alert alert-success mb-2 mt-2"
                    *ngIf="isAddCameraSuccess"
                    role="alert">
                    {{ responseMessage }}
                </div>
                <div class="alert alert-danger mb-2 mt-3" *ngIf="isAddCameraFail" role="alert">
                    {{ responseMessage }}
                </div>
                <button
                    type="submit"
                    class="mt-3"
                    (click)="AddCameraSubmit()"
                    [disabled]="!isAddCamFormValid || isAddCamLoading">
                    <span *ngIf="!isAddCamLoading">Submit</span>
                    <span
                        class="spinner-border spinner-border-sm me-1"
                        role="status"
                        aria-hidden="true"
                        *ngIf="isAddCamLoading">
                    </span>
                </button>
            </form>
            <form action="" class="" [formGroup]="AddCameraForm" id="addCameraForm" *ngIf="addCameraMethod.value=='camera_rtsp'">

                <div class="wrapper-two" id="input">
                    <div class="form-floating">
                        <input
                            type="text"
                            [ngClass]="
                            AddCameraForm.get('cameraname').invalid &&
                            AddCameraForm.get('cameraname').touched
                            ? 'is-invalid'
                            : ''
                            "
                            formControlName="cameraname"
                            placeholder="Camera name"
                            class="form-control"
                            id="cameraname"
                        />
                        <label for="cameraname">
                            Camera Name
                        </label>
                    </div>

                    <div class="form-floating" id="cameraBrand">
             
                        <ng-multiselect-dropdown
                            #singleSelect
                            [placeholder]="'Camera Brand'"
                            [settings]="cameraBrandDropdownSettings | async"
                            [data]="cameraBrandList | async"
                            formControlName="camera_brand">
                        </ng-multiselect-dropdown>
                    </div>
  
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="plant"
                            placeholder="Plant"
                            class="form-control"
                            [ngClass]="
                            AddCameraForm.get('plant').invalid &&
                            AddCameraForm.get('plant').touched
                            ? 'is-invalid'
                            : ''
                            "
                            id="plant"
                        />
                        <label for="plant">
                            Plant
                        </label>
                    </div>
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="area"
                            placeholder="Area"
                            class="form-control"
                            [ngClass]="
                            AddCameraForm.get('area').invalid &&
                            AddCameraForm.get('area').touched
                            ? 'is-invalid'
                            : ''
                            "
                            id="Area"
                        />
                        <label for="Area">
                            Area
                        </label>
                    </div>
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="department"
                            placeholder="Department"
                            class="form-control"
                            [ngClass]="
                            AddCameraForm.get('department').invalid &&
                            AddCameraForm.get('department').touched
                            ? 'is-invalid'
                            : ''
                            "
                            id="department"
                        />
                        <label for="department">
                            Department
                        </label>
                    </div>
                </div>
  
                <div class="wrapper-two" id="input">
                    <div class="">
                        <div class="form-floating">
                            <input
                                type="text"
                                formControlName="rtsp_url"
                                placeholder="Camera RTSP"
                                class="form-control"
                                [ngClass]="
                                    AddCameraForm.get('rtsp_url').invalid &&
                                    AddCameraForm.get('rtsp_url').touched
                                    ? 'is-invalid'
                                    : ''
                                "
                                id="username"
                            />
                            <label for="username">RTSP URL</label>
                        </div>
                    </div> 
                </div>

                <div
                    class="alert alert-success mb-2 mt-2"
                    *ngIf="isAddCameraSuccess"
                    role="alert">
                    {{ responseMessage }}
                </div>
                <div class="alert alert-danger mb-2 mt-3" *ngIf="isAddCameraFail" role="alert">
                    {{ responseMessage }}
                </div>
                <button
                    type="submit"
                    class="mt-3"
                    (click)="AddCameraSubmit()"
                    [disabled]="!isAddCamFormValid || isAddCamLoading">
                    <span *ngIf="!isAddCamLoading">Submit</span>
                    <span
                        class="spinner-border spinner-border-sm me-1"
                        role="status"
                        aria-hidden="true"
                        *ngIf="isAddCamLoading">
                    </span>
                </button>
            </form>
            <div *ngIf="addCameraMethod.value == 'excel'" class="row">
                <div class="col-12">
                    <div class="column-grid">
                        <div class="w-100 h-50">
                            <app-file-uploader
                                (OnFileUploaded)="OnJobsheetUploaded($event)">
                            </app-file-uploader>
                        </div>

                        <div class="p-2 d-flex justify-content-center">
                            <button
                                type="submit"
                                class="w-auto"
                                [disabled]="isAddCamViaExcelLoading"
                                *ngIf="jobFileStatus"
                                (click)="OnAddMechJobsBySheet()">
                                <span *ngIf="!isAddCamViaExcelLoading">Submit Jobsheet </span>
                                <span *ngIf="isAddCamViaExcelLoading">
                                    <span
                                    class="spinner-border spinner-border-sm me-1"
                                    role="status"
                                    aria-hidden="true">
                                    </span>
                                    Adding...
                                </span>
                            </button>
                        </div>
                        <div class="row">
                            <div
                                *ngIf="isAddCamViaExcelLoading"
                                class="d-flex justify-centent-center align-items-center ms-3">
                                    <span class="text-warning">
                                         Do not close the popup or switch to other job adding type
                                        untill you get the response.
                                    </span>
                            </div>
                        </div>
                    </div>
                    <div class="mt-2">
                        <div
                            class="alert alert-success mb-2"
                            *ngIf="isAddCameraSuccess"
                            role="alert">
                                {{ responseMessage }}
                        </div>
                        <div class="alert alert-danger mb-2" *ngIf="isAddCameraFail" role="alert">
                            {{ responseMessage }}
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>
</ng-template>
  
  <!-- template to edit the camera details
   -->
<ng-template let-modal #editCameraModal>
    <div class="border">
        <div class="modal-header" id="formContent">
            <h4>
                <b>Edit Camera Details</b>
            </h4>
            <button
                type="button"
                class="btn btn-close"
                aria-label="Close"
                (click)="modal.close('Cross click')">
            </button>
        </div>
        <div class="modal-body">
            <form action="" class="" [formGroup]="EditCameraForm" id="addCameraForm">
                <div class="wrapper-two" id="input">
                    <div class="form-floating">
                        <input
                            type="text"
                            [ngClass]="
                            EditCameraForm.get('cameraname').invalid &&
                            EditCameraForm.get('cameraname').touched
                            ? 'is-invalid'
                            : ''
                            "
                            formControlName="cameraname"
                            placeholder="Camera name"
                            class="form-control"
                            id="cameraname"
                        />
                        <label for="cameraname">Camera Name</label>
                    </div>
  
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="plant"
                            placeholder="Plant"
                            class="form-control"
                            [ngClass]="
                                EditCameraForm.get('plant').invalid &&
                                EditCameraForm.get('plant').touched
                                ? 'is-invalid'
                                : ''
                            "
                            id="plant"
                        />
                        <label for="plant">Plant</label>
                    </div>
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="area"
                            placeholder="Area"
                            class="form-control"
                            [ngClass]="
                                EditCameraForm.get('area').invalid &&
                                EditCameraForm.get('area').touched
                                ? 'is-invalid'
                                : ''
                                "
                            id="Area"
                        />
                        <label for="Area">Area</label>
                    </div>
  
                    <div class="form-floating">
                        <input
                            type="text"
                            formControlName="department"
                            placeholder="Department"
                            class="form-control"
                            [ngClass]="
                                EditCameraForm.get('department').invalid &&
                                EditCameraForm.get('department').touched
                                    ? 'is-invalid'
                                    : ''
                                "
                            id="department"
                        />
                        <label for="department">Department</label>
                    </div>
                </div>
  
                
                <div
                    class="alert alert-success mb-2 mt-2"
                    *ngIf="isAddCameraSuccess"
                    role="alert">
                     {{ responseMessage }}
                </div>
                <div class="alert alert-danger mb-2 mt-3" *ngIf="isAddCameraFail" role="alert">
                    {{ responseMessage }}
                </div>
                <button
                    type="submit"
                    class="mt-3"
                    (click)="OnEditCameraDetails()"
                    [disabled]="isAddCamLoading">
                    <span *ngIf="!isAddCamLoading">Submit</span>
                    <span
                        class="spinner-border spinner-border-sm me-1"
                        role="status"
                        aria-hidden="true"
                        *ngIf="isAddCamLoading">
                    </span>
                </button>
            </form>
        </div>
    </div>
</ng-template>

<ng-template let-modal #deleteModal>
    <div class="modal-body">
        <div class="modal-confirm">
            <div class="modal-content">
                <div class="modal-header flex-column">
                    <div class="icon-box">
                        <i class="material-icons">&#xE5CD;</i>
                    </div>
                    <h4 class="modal-title w-100">Are you sure?</h4>
                    <!-- <button type="button" class="btn"  aria-hidden="true">&times;</button> -->
                </div>
                <div class="modal-body">
                    <p>
                        Do you really want to delete this Camera? This process cannot be
                        undone.
                    </p>
                </div>
                <div class="modal-footer justify-content-center">
                    <button
                        type="button"
                        class="btn btn-secondary"
                        (click)="modal.close('Cross click')"
                        data-dismiss="modal">
                        Cancel
                    </button>
                    <button type="button" class="btn danger" (click)="DeleteCamera()">
                        Delete
                    </button>
                </div>
            </div>
        </div>
    </div>
</ng-template>
  

  
  
<ng-template let-modal #errorMessage>
    <div class="modal-body">
        <div class="modal-confirm">
            <div class="modal-content">
                <div class="modal-header flex-column">
                    <div class="icon-box">
                        <i class="material-icons">&#33;</i>
                    </div>
                    <h4 class="modal-title w-100">Limit has reached!</h4>
                        <!-- <button type="button" class="btn"  aria-hidden="true">&times;</button> -->
                </div>
                <div class="modal-body">
                    <p>{{ licenseMessage }}</p>
                </div>
                <div class="modal-footer justify-content-center">
                    <button
                    type="button"
                    class="btn btn-secondary"
                    (click)="modal.close('Cross click')"
                    data-dismiss="modal">
                        Okay
                    </button>
                </div>
            </div>
        </div>
    </div>
</ng-template>
  

  
  

  
  
  
  
  